(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45695,       1354]
NotebookOptionsPosition[     40169,       1152]
NotebookOutlinePosition[     41044,       1181]
CellTagsIndexPosition[     41001,       1178]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["HW 5 - AstroDynamics",
 FontSize->36]], "Title",
 CellChangeTimes->{{3.654006862829466*^9, 3.6540068685167913`*^9}, 
   3.654035069661324*^9}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Daniel George",
 FontSize->24]], "Chapter",
 CellChangeTimes->{{3.654006871588967*^9, 3.654006873829095*^9}}],

Cell[CellGroupData[{

Cell["Q1", "Subchapter",
 CellChangeTimes->{{3.654007115961944*^9, 3.654007133097924*^9}}],

Cell[CellGroupData[{

Cell["\<\
In the Jeans equation for an isothermal system the first two terms are zero \
(since mean velocity is constant), this gives:\
\>", "Subsection",
 CellChangeTimes->{{3.6540075305256557`*^9, 3.654007576820304*^9}, {
   3.654008451715345*^9, 3.6540084855542803`*^9}, {3.6540093983054867`*^9, 
   3.6540093998005724`*^9}, 3.654009519135398*^9, {3.654009600454049*^9, 
   3.6540096006380596`*^9}, 3.6540338933770447`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", "x", "]"}], ",", "x"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Rho]", "[", "x", "]"}]}], "/", "M"}], ")"}]}], "-", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sigma]", "^", "2"}], 
       RowBox[{
        RowBox[{"\[Rho]", "[", "x", "]"}], "/", "M"}]}], " ", ",", "x"}], 
     "]"}]}], "\[Equal]", "0"}]}]], "Input",
 CellChangeTimes->{{3.653941973730156*^9, 3.653942082524624*^9}, {
  3.65394263507856*^9, 3.653942703650303*^9}, {3.653943206032346*^9, 
  3.653943226874543*^9}, {3.653947937238655*^9, 3.653947940433983*^9}, {
  3.6540095770877123`*^9, 3.6540095883833585`*^9}, {3.6540320147685947`*^9, 
  3.6540320287263927`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[Sigma]", "2"], " ", 
      RowBox[{
       SuperscriptBox["\[Rho]", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], "M"]}], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"\[Rho]", "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Phi]", "\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}], "M"]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{{3.653942061358555*^9, 3.653942083034289*^9}, 
   3.653942670397357*^9, {3.6539427214816093`*^9, 3.653942739926261*^9}, 
   3.6539428429979877`*^9, {3.6539432092839127`*^9, 3.653943227239622*^9}, 
   3.653947941864253*^9, 3.6540073298701787`*^9, 3.654008551066027*^9, {
   3.654009580083884*^9, 3.6540095887363787`*^9}, {3.6540320083372264`*^9, 
   3.6540320296554456`*^9}, 3.6540325185154066`*^9, 3.654032745888412*^9, 
   3.6540330257954216`*^9, 3.6540331344016333`*^9, 3.6540422149700127`*^9, 
   3.6544519628021927`*^9, 3.654452247911574*^9},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving for \[Phi]\[CloseCurlyQuote][x]:", "Subsection",
 CellChangeTimes->{{3.654007220680934*^9, 3.6540072320245824`*^9}, {
  3.654008555850301*^9, 3.6540085578104134`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{"eq1", ",", 
    RowBox[{
     RowBox[{"\[Phi]", "'"}], "[", "x", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.653943251597741*^9, 3.6539432718158283`*^9}, 
   3.654032035390774*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Phi]", "\[Prime]",
      MultilineFunction->None], "[", "x", "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Sigma]", "2"], " ", 
       RowBox[{
        SuperscriptBox["\[Rho]", "\[Prime]",
         MultilineFunction->None], "[", "x", "]"}]}], 
      RowBox[{"\[Rho]", "[", "x", "]"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.6539432672662973`*^9, 3.65394327230051*^9}, 
   3.6540073312762594`*^9, 3.6540085696960926`*^9, 3.65403203672185*^9, 
   3.654032518552409*^9, 3.654032745927414*^9, 3.6540330258374243`*^9, 
   3.6540331353076854`*^9, 3.6540422150480165`*^9, 3.6544519628645926`*^9, 
   3.6544522480051737`*^9},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Substituting the above for \[Phi]\[CloseCurlyQuote][x] in the Poisson\
\[CloseCurlyQuote]s equation:", "Subsection",
 CellChangeTimes->{{3.654007203168932*^9, 3.6540072882157965`*^9}, {
  3.654007540877248*^9, 3.65400754301337*^9}, {3.654009025941189*^9, 
  3.654009026805238*^9}, {3.654009083508481*^9, 3.654009115500311*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq2", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"x", " ", 
         RowBox[{
          RowBox[{"\[Phi]", "'"}], "[", "x", "]"}]}], "/.", 
        RowBox[{"s", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "x"}], "]"}], "/", "x"}], 
    "\[Equal]", 
    RowBox[{"4", " ", "Pi", " ", "G", " ", 
     RowBox[{"\[Rho]", "[", "x", "]"}]}]}], " ", "//", "Expand"}]}]], "Input",\

 CellChangeTimes->{{3.653942084381783*^9, 3.653942089860539*^9}, {
   3.6539424928115177`*^9, 3.6539425431841707`*^9}, {3.653943299110792*^9, 
   3.653943303933257*^9}, {3.653943545901106*^9, 3.653943550340814*^9}, {
   3.65394362170691*^9, 3.6539436256173477`*^9}, 3.653943869077387*^9, {
   3.653945296082666*^9, 3.65394530876717*^9}, {3.6540073209766703`*^9, 
   3.6540073611759696`*^9}, {3.654007971136857*^9, 3.654007982320497*^9}, {
   3.654008012433219*^9, 3.65400801680847*^9}, {3.654008333309572*^9, 
   3.6540083369647818`*^9}, {3.6540320397590237`*^9, 3.6540320535978155`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[Sigma]", "2"], " ", 
      RowBox[{
       SuperscriptBox["\[Rho]", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], 
     RowBox[{"x", " ", 
      RowBox[{"\[Rho]", "[", "x", "]"}]}]]}], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[Sigma]", "2"], " ", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["\[Rho]", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}], "2"]}], 
    SuperscriptBox[
     RowBox[{"\[Rho]", "[", "x", "]"}], "2"]], "-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[Sigma]", "2"], " ", 
     RowBox[{
      SuperscriptBox["\[Rho]", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}], 
    RowBox[{"\[Rho]", "[", "x", "]"}]]}], "\[Equal]", 
  RowBox[{"4", " ", "G", " ", "\[Pi]", " ", 
   RowBox[{"\[Rho]", "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.653942545606845*^9, 3.653942742462447*^9, 3.6539433071932907`*^9, 
   3.65394355101925*^9, 3.653943626084042*^9, 3.653943869893821*^9, {
   3.653945300935153*^9, 3.653945309265156*^9}, {3.6540073254069233`*^9, 
   3.6540073615589914`*^9}, 3.654007983389558*^9, 3.6540080196756334`*^9, 
   3.6540085738003273`*^9, 3.654032058290084*^9, 3.65403251856341*^9, 
   3.6540327459384146`*^9, 3.6540330258464246`*^9, 3.654033136682764*^9, 
   3.6540422150580177`*^9, 3.6544519628645926`*^9, 3.654452248020774*^9},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Trying to solve this differential equation:", "Subsection",
 CellChangeTimes->{{3.654008588425164*^9, 3.654008606129177*^9}, {
  3.654015224657668*^9, 3.654015225104694*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"eq2", ",", 
     RowBox[{
      RowBox[{"\[Rho]", "[", "0", "]"}], "\[Equal]", "\[Rho]0"}], ",", 
     RowBox[{
      RowBox[{"\[Rho]", "[", "Infinity", "]"}], "\[Equal]", "0"}]}], "}"}], 
   ",", 
   RowBox[{"\[Rho]", "[", "x", "]"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.653942558467863*^9, 3.65394263290086*^9}, {
  3.65394331722985*^9, 3.653943324925325*^9}, {3.653943355306902*^9, 
  3.653943364265389*^9}, {3.6539434360688353`*^9, 3.653943436820611*^9}, {
  3.6539434710357113`*^9, 3.653943481967792*^9}, {3.653943892882348*^9, 
  3.6539439449611883`*^9}, {3.653943979718054*^9, 3.653943994533655*^9}, {
  3.653944069464603*^9, 3.653944077814829*^9}, {3.653944355639331*^9, 
  3.6539443624933767`*^9}, {3.653944630163868*^9, 3.653944641505899*^9}, {
  3.654032061854287*^9, 3.654032067181592*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.6539425723487043`*^9, 3.653942580891905*^9}, 
   3.653942624385021*^9, 3.653942746509686*^9, 3.653943337155142*^9, 
   3.653943415567622*^9, 3.653943448196806*^9, 3.6539434935884523`*^9, 
   3.653943616664033*^9, 3.653943999266994*^9, 3.653944422612747*^9, 
   3.653944625164316*^9, 3.65394478308575*^9, 3.653946022118064*^9, 
   3.654007442536623*^9, 3.6540078402093687`*^9, 3.6540079976143713`*^9, 
   3.6540080322303514`*^9, 3.6540323622374687`*^9, 3.6540325290430093`*^9, 
   3.654032756485018*^9, 3.6540330364130287`*^9, 3.654033189560788*^9, 
   3.654042283515933*^9, 3.6544519844336414`*^9, 3.6544522607965975`*^9}]
}, Open  ]],

Cell["\<\
Unable to solve this second order nonlinear differential equation \
analytically. Alternately we can show that the given solution is a solution \
of this equation. This solution must be the unique solution since we have two \
boundary conditions at zero and infinity.\
\>", "Text",
 CellChangeTimes->{{3.654008713736332*^9, 3.654008795030981*^9}, {
  3.6540152283528795`*^9, 3.6540152539453435`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The solution given in the question is:", "Subsection",
 CellChangeTimes->{{3.6540073661912565`*^9, 3.6540073751747704`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"p1", "[", "x_", "]"}], "=", 
  RowBox[{
   SubscriptBox["\[Rho]", "0"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Pi", " ", "G", " ", 
       SubscriptBox["\[Rho]", "0"], " ", 
       RowBox[{
        RowBox[{"x", "^", "2"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", 
          RowBox[{"\[Sigma]", "^", "2"}]}], ")"}]}]}]}], ")"}], "^", 
    RowBox[{"-", "2"}]}]}]}]], "Input",
 CellChangeTimes->{{3.653944860344816*^9, 3.653944928339505*^9}, {
  3.654032073149934*^9, 3.654032094117133*^9}, {3.65403226610997*^9, 
  3.654032272364328*^9}}],

Cell[BoxData[
 FractionBox[
  SubscriptBox["\[Rho]", "0"], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"G", " ", "\[Pi]", " ", 
       SuperscriptBox["x", "2"], " ", 
       SubscriptBox["\[Rho]", "0"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Sigma]", "2"]}]]}], ")"}], "2"]]], "Output",
 CellChangeTimes->{
  3.6539449383467417`*^9, {3.6540073373666077`*^9, 3.654007363139082*^9}, 
   3.654008854601389*^9, 3.6540088967578*^9, 3.65403209547021*^9, 
   3.6540322751844893`*^9, 3.654032529079011*^9, 3.6540327565220203`*^9, 
   3.6540330364550314`*^9, 3.6540331919919276`*^9, 3.654042295013591*^9, 
   3.654451989973052*^9, 3.654452128384117*^9, 3.6544522686230125`*^9},
 FontSize->18]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Plugging in the given solution and showing that it satisfies the differential \
equation:\
\>", "Subsection",
 CellChangeTimes->{{3.654007379295006*^9, 3.6540074064065566`*^9}, {
  3.654008619616948*^9, 3.6540086964083405`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eq2", "/.", 
   RowBox[{"{", 
    RowBox[{"\[Rho]", "\[Rule]", "p1"}], "}"}]}], "//", "Simplify"}]], "Input",\

 CellChangeTimes->{{3.653944940334394*^9, 3.653944962768466*^9}, {
  3.654033200457412*^9, 3.654033202217512*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.653944955230534*^9, 3.65394496334833*^9}, {
   3.654007338895695*^9, 3.654007352061448*^9}, 3.6540074110518227`*^9, 
   3.6540081095237727`*^9, 3.6540089000379877`*^9, 3.654032277066597*^9, 
   3.6540325291000123`*^9, 3.654032756543021*^9, 3.6540330364770327`*^9, {
   3.6540331934230094`*^9, 3.6540332052076836`*^9}, 3.654042295061593*^9, 
   3.654451990035452*^9, 3.6544521297573195`*^9, 3.654452268669812*^9},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Also checking initial conditions; density at zero = ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "0"], TraditionalForm]]],
 " and density at infinity = 0"
}], "Subsection",
 CellChangeTimes->{{3.6540321315242724`*^9, 3.6540321418288617`*^9}, {
  3.6540322186672564`*^9, 3.6540322379163575`*^9}, {3.654032323434249*^9, 
  3.6540323371060305`*^9}, {3.6540335452771344`*^9, 3.654033546149184*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"p1", "[", "0", "]"}], ",", 
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{"p1", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", "\[Rule]", "Infinity"}], "}"}]}], "]"}]}], "}"}]], "Input",\

 CellChangeTimes->{{3.654032143929982*^9, 3.654032179445013*^9}, {
  3.654032212307893*^9, 3.6540322137879777`*^9}, {3.6540322860991135`*^9, 
  3.6540323148267565`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["\[Rho]", "0"], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6540321486602526`*^9, 3.6540321798800383`*^9}, 
   3.6540322141749997`*^9, {3.6540322792477217`*^9, 3.654032317080886*^9}, 
   3.654032529110013*^9, 3.654032756553022*^9, 3.6540330364860334`*^9, 
   3.654033209049903*^9, 3.654042295080594*^9, 3.654451990051052*^9, 
   3.6544521308429213`*^9, 3.6544522686854124`*^9},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell["\<\
Thus the given solution is a particular solution for this differential \
equation.\
\>", "Subsection",
 CellChangeTimes->{{3.6540329150440874`*^9, 3.6540329424356537`*^9}, 
   3.6540354887522945`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Q3", "Subchapter",
 CellChangeTimes->{{3.654007115961944*^9, 3.6540071171540127`*^9}}],

Cell[CellGroupData[{

Cell["a)", "Section",
 CellChangeTimes->{{3.6540277311335845`*^9, 3.654027731477604*^9}}],

Cell[CellGroupData[{

Cell["The distribution function is given as:", "Subsection",
 CellChangeTimes->{{3.654031466356227*^9, 3.654031473283623*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "Ez_", "]"}], "=", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Rho]", "0"], " ", "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"2", " ", "Pi", " ", 
      RowBox[{"\[Sigma]", "^", "2"}]}], "]"}]}], " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "Ez"}], "/", 
     RowBox[{"\[Sigma]", "^", "2"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6540121333018527`*^9, 3.654012136518037*^9}, {
   3.6540123472660913`*^9, 3.6540123936887465`*^9}, {3.654013326407095*^9, 
   3.6540133313583775`*^9}, {3.654013402853467*^9, 3.6540134068296947`*^9}, 
   3.6540323744111643`*^9, {3.654032951564176*^9, 3.6540329531642675`*^9}, {
   3.654033219449498*^9, 3.654033219609507*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox["Ez", 
      SuperscriptBox["\[Sigma]", "2"]]}]], " ", 
   SubscriptBox["\[Rho]", "0"]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SqrtBox[
    SuperscriptBox["\[Sigma]", "2"]]}]]], "Output",
 CellChangeTimes->{
  3.6540123946057987`*^9, {3.6540133321354227`*^9, 3.654013350942498*^9}, 
   3.6540134072467184`*^9, 3.6540144757718344`*^9, 3.6540315047444224`*^9, 
   3.6540323799354806`*^9, 3.6540325291200137`*^9, 3.6540327565630226`*^9, 
   3.654032956544461*^9, 3.6540330364960337`*^9, 3.6540332200705338`*^9, 
   3.654042295088595*^9, 3.654451990051052*^9, 3.654452132209325*^9, 
   3.6544522686854124`*^9},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Energy Ez is given in terms of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", "z"], "and", " ", "z"}], TraditionalForm]]],
 ":"
}], "Subsection",
 CellChangeTimes->{{3.654027737211932*^9, 3.6540277699008017`*^9}, {
  3.654031424851853*^9, 3.6540314351724434`*^9}, {3.654031478035895*^9, 
  3.6540314919976935`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sz", "=", 
  RowBox[{"Ez", "\[Rule]", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", 
     RowBox[{"vz", "^", "2"}]}], "+", 
    RowBox[{"\[CapitalPhi]", "[", "z", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6540278332884274`*^9, 3.654027890980727*^9}, 
   3.654032743791292*^9}],

Cell[BoxData[
 RowBox[{"Ez", "\[Rule]", 
  RowBox[{
   FractionBox[
    SuperscriptBox["vz", "2"], "2"], "+", 
   RowBox[{"\[CapitalPhi]", "[", "z", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.654027874802802*^9, 3.654027892294802*^9}, 
   3.654031506157503*^9, 3.654032529130014*^9, 3.654032756573023*^9, 
   3.654033036509034*^9, 3.6540332226756825`*^9, 3.6540422950985956`*^9, 
   3.6544519900666523`*^9, 3.65445209897686*^9, 3.654452148112167*^9, 
   3.6544522687010126`*^9},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The density is found by integrating the distribution function over all \
velocities:\
\>", "Subsection",
 CellChangeTimes->{{3.6540279150031013`*^9, 3.6540279365473332`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sp", "=", 
  RowBox[{
   RowBox[{"\[Rho]", "[", "z", "]"}], "->", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "Ez", "]"}], "/.", "sz"}], ",", 
     RowBox[{"{", 
      RowBox[{"vz", ",", 
       RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\[Sigma]", ">", "0"}], "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.654027772721963*^9, 3.6540278201326747`*^9}, {
   3.6540278680284147`*^9, 3.654027908059704*^9}, {3.6540279492680607`*^9, 
   3.654027958490588*^9}, {3.654028013556738*^9, 3.654028017890986*^9}, 
   3.6540329627578163`*^9, {3.65403325549656*^9, 3.654033257321664*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]", "[", "z", "]"}], "\[Rule]", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[CapitalPhi]", "[", "z", "]"}], 
      SuperscriptBox["\[Sigma]", "2"]]}]], " ", 
   SubscriptBox["\[Rho]", "0"]}]}]], "Output",
 CellChangeTimes->{{3.6540279450318184`*^9, 3.6540279594936457`*^9}, 
   3.654028018790037*^9, 3.654031507902603*^9, 3.6540325293080244`*^9, 
   3.6540327570680513`*^9, 3.6540329643779087`*^9, 3.654033036676044*^9, 
   3.6540332276399665`*^9, 3.654033258261718*^9, 3.6540422958006353`*^9, 
   3.654451991004654*^9, 3.6544521010082645`*^9, 3.6544521581839857`*^9, 
   3.654452269497614*^9},
 FontSize->18]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Poisson equation gives:", "Subsection",
 CellChangeTimes->{{3.654027980593853*^9, 3.654027985746147*^9}, 
   3.6540354840490255`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqP", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"\[CapitalPhi]", "[", "z", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "2"}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{"4", " ", "Pi", " ", "G", " ", 
     RowBox[{"\[Rho]", "[", "z", "]"}]}]}], "/.", "sp"}]}]], "Input",
 CellChangeTimes->{{3.654027988644313*^9, 3.65402804943379*^9}, {
   3.6540285782290354`*^9, 3.654028579232093*^9}, {3.654029867941803*^9, 
   3.6540298682618213`*^9}, {3.654032425834106*^9, 3.654032461161126*^9}, 
   3.6540326842788877`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[CapitalPhi]", "\[Prime]\[Prime]",
    MultilineFunction->None], "[", "z", "]"}], "\[Equal]", 
  RowBox[{"4", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[CapitalPhi]", "[", "z", "]"}], 
      SuperscriptBox["\[Sigma]", "2"]]}]], " ", "G", " ", "\[Pi]", " ", 
   SubscriptBox["\[Rho]", "0"]}]}]], "Output",
 CellChangeTimes->{
  3.6540324618061633`*^9, 3.6540325293170247`*^9, 3.654032688192112*^9, 
   3.654032757078052*^9, 3.6540330366850443`*^9, {3.654033241747773*^9, 
   3.6540332596807995`*^9}, {3.654035738441576*^9, 3.6540357393716297`*^9}, 
   3.654042295809636*^9, 3.654451991100254*^9, 3.654452269513214*^9},
 FontSize->18]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Substituting t =\[Zeta] = z/z0, \[CapitalPhi][\[Zeta]] = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Sigma]", "2"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " \[Phi][\[Zeta]]"
}], "Subsection",
 CellChangeTimes->{{3.6540286388165007`*^9, 3.6540286612667847`*^9}, {
  3.6540300908675537`*^9, 3.6540301102046595`*^9}, {3.654033451591776*^9, 
  3.6540334595392303`*^9}, {3.6540364241837983`*^9, 3.6540364298071203`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", "\[Zeta]"}], ";"}]], "Input",
 CellChangeTimes->{{3.654031345296303*^9, 3.654031347766444*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"st", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalPhi]", "[", "z", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "t", "]"}], " ", 
      RowBox[{"\[Sigma]", "^", "2"}]}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPhi]", "''"}], "[", "z", "]"}], "\[Rule]", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "''"}], "[", "t", "]"}], 
      RowBox[{
       RowBox[{"\[Sigma]", "^", "2"}], "/", 
       RowBox[{"z0", "^", "2"}]}]}]}], ",", 
    RowBox[{"z0", "\[Rule]", 
     RowBox[{"\[Sigma]", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"8", "Pi", " ", "G", " ", 
        SubscriptBox["\[Rho]", "0"]}], "]"}]}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.654029154072972*^9, 3.654029197389449*^9}, {
   3.6540293387875366`*^9, 3.654029375291625*^9}, {3.654029505019045*^9, 
   3.654029513010502*^9}, {3.654029544354295*^9, 3.6540295912889795`*^9}, {
   3.6540297020883164`*^9, 3.6540297408725348`*^9}, {3.654030208891304*^9, 
   3.654030221826044*^9}, 3.6540302958972807`*^9, {3.654030747629118*^9, 
   3.6540307478681316`*^9}, 3.654031083962355*^9, {3.654031180760892*^9, 
   3.654031215031852*^9}, {3.6540326904402404`*^9, 3.6540327028879523`*^9}, {
   3.654032977719672*^9, 3.6540329798357925`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalPhi]", "[", "z", "]"}], "\[Rule]", 
    RowBox[{
     SuperscriptBox["\[Sigma]", "2"], " ", 
     RowBox[{"\[Phi]", "[", "\[Zeta]", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[CapitalPhi]", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "z", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[Sigma]", "2"], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "\[Zeta]", "]"}]}], 
     SuperscriptBox["z0", "2"]]}], ",", 
   RowBox[{"z0", "\[Rule]", 
    FractionBox["\[Sigma]", 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{"2", " ", "\[Pi]"}]], " ", 
      SqrtBox[
       RowBox[{"G", " ", 
        SubscriptBox["\[Rho]", "0"]}]]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6540312153498697`*^9, 3.6540313495965486`*^9, 3.6540315132139072`*^9, 
   3.6540324649673443`*^9, 3.654032529335026*^9, {3.6540326967015986`*^9, 
   3.6540327046390524`*^9}, 3.654032757094053*^9, 3.654032981634896*^9, 
   3.654033036703046*^9, 3.6540332638120356`*^9, 3.654042295825637*^9, 
   3.6544519911158543`*^9, 3.6544520703520064`*^9, 3.6544522695444136`*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqt", "=", 
  RowBox[{
   RowBox[{"eqP", "//.", "st"}], " ", "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6540297479419394`*^9, 3.6540297513991365`*^9}, 
   3.6540298030400906`*^9, 3.654029840742247*^9, {3.6540302431852655`*^9, 
   3.654030256418022*^9}, {3.654030319352622*^9, 3.6540303303202496`*^9}, {
   3.654030787107376*^9, 3.654030817435111*^9}, {3.6540312206871758`*^9, 
   3.6540312786784925`*^9}, {3.654031543107617*^9, 3.6540315453077426`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"G", " ", 
   SubscriptBox["\[Rho]", "0"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       RowBox[{"\[Phi]", "[", "\[Zeta]", "]"}]}]], "-", 
     RowBox[{"2", " ", 
      RowBox[{
       SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "\[Zeta]", "]"}]}]}], ")"}]}], 
  "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{
  3.654029751930167*^9, 3.654029803744131*^9, 3.654029841298279*^9, 
   3.6540298824016294`*^9, 3.6540301710301385`*^9, {3.6540302160007105`*^9, 
   3.6540302572990727`*^9}, {3.654030301451598*^9, 3.6540303307882757`*^9}, {
   3.6540307639390507`*^9, 3.65403081777613*^9}, 3.6540310889316397`*^9, {
   3.654031188285322*^9, 3.654031279425535*^9}, 3.654031351858678*^9, 
   3.6540315458947763`*^9, 3.6540324666714416`*^9, 3.6540325295780396`*^9, {
   3.654032698358693*^9, 3.6540327155146747`*^9}, 3.6540327572970643`*^9, 
   3.6540329853101063`*^9, 3.6540330369150577`*^9, 3.654033278521877*^9, 
   3.6540422960226483`*^9, 3.6544519913342543`*^9, 3.654452083688031*^9, 
   3.6544522697356143`*^9},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "Which is the required equation since G*",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Rho]", "0"], "\[NotEqual]", " ", "0"}], TraditionalForm]]],
 "."
}], "Subsection",
 CellChangeTimes->{{3.654031290078144*^9, 3.6540313160216284`*^9}, 
   3.6540354996479177`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["b)", "Section",
 CellChangeTimes->{{3.653946740228149*^9, 3.653946751017807*^9}, {
  3.654007070698355*^9, 3.6540070720344315`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sQ", "=", 
  RowBox[{"DSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eqt", ",", 
      RowBox[{
       RowBox[{"\[Phi]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], 
    ",", 
    RowBox[{"\[Phi]", "[", "t", "]"}], ",", "t"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6539372219331512`*^9, 3.653937246578549*^9}, {
  3.653937344322372*^9, 3.653937385868906*^9}, {3.653937419159833*^9, 
  3.6539374600334787`*^9}, {3.6539374932685127`*^9, 3.653937494446398*^9}, {
  3.653938525333494*^9, 3.65393857624522*^9}, {3.653946647949335*^9, 
  3.653946648195846*^9}, {3.6540122181957083`*^9, 3.654012241315031*^9}, {
  3.6540143822354846`*^9, 3.654014413690284*^9}, {3.654015178074004*^9, 
  3.654015186513487*^9}, {3.6540315505410423`*^9, 3.6540315697791424`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Phi]", "[", "\[Zeta]", "]"}], "\[Rule]", 
    RowBox[{"Log", "[", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "\[Zeta]"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[ExponentialE]", "\[Zeta]"]}], ")"}], "2"]}], 
     "]"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.653937463947893*^9, 3.6539374955036507`*^9, {3.6539385336034822`*^9, 
   3.65393857904624*^9}, 3.653946649784555*^9, 3.654006958761953*^9, {
   3.6540122363807487`*^9, 3.6540122418710628`*^9}, {3.654014398868436*^9, 
   3.6540144144403267`*^9}, 3.654015188456598*^9, 3.654031572500298*^9, 
   3.6540324687925625`*^9, 3.654032529897058*^9, 3.6540327576000814`*^9, 
   3.6540329879832587`*^9, 3.654033037219075*^9, 3.6540332824901037`*^9, 
   3.654042296348667*^9, 3.654451991396655*^9, {3.6544520342081375`*^9, 
   3.65445205687318*^9}, 3.6544522701412153`*^9},
 FontSize->16]
}, Open  ]],

Cell[CellGroupData[{

Cell["Thus the density function is given by:", "Subsection",
 CellChangeTimes->{{3.6540069183726425`*^9, 3.654006932764466*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[Rho]", "0"], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], "/.", 
    RowBox[{"sQ", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{"t", "->", 
     RowBox[{"z", "/", "z0"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.65393796467527*^9, 3.653938020125886*^9}, {
   3.653938138446233*^9, 3.653938138862588*^9}, {3.6539381990526743`*^9, 
   3.653938203948771*^9}, {3.653946669221767*^9, 3.6539466762110157`*^9}, {
   3.654012247890407*^9, 3.65401228780169*^9}, {3.6540144174264975`*^9, 
   3.6540144198416357`*^9}, 3.654015191514773*^9, 3.654032481481289*^9, {
   3.6540333020482225`*^9, 3.654033303369298*^9}, {3.654452050156768*^9, 
   3.654452055310177*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"z", "/", "z0"}]], " ", 
   SubscriptBox["\[Rho]", "0"]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"z", "/", "z0"}]]}], ")"}], "2"]]], "Output",
 CellChangeTimes->{
  3.653937999096365*^9, 3.653938031188014*^9, {3.653938176043359*^9, 
   3.65393820483963*^9}, 3.6539466773565083`*^9, 3.6540069590399685`*^9, 
   3.654012248401436*^9, 3.6540122883777227`*^9, 3.6540144202276573`*^9, 
   3.65401519216281*^9, 3.6540315767415404`*^9, 3.6540324707846766`*^9, 
   3.654032529911059*^9, 3.654032757632084*^9, 3.654033037231076*^9, {
   3.6540332844032135`*^9, 3.6540333043943567`*^9}, 3.6540422964466724`*^9, 
   3.654451991412255*^9, {3.65445203549654*^9, 3.654452052137971*^9}, 
   3.6544522701568155`*^9},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The solution given in the question:", "Subsection",
 CellChangeTimes->{{3.6540069034837914`*^9, 3.654006938235779*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P2", "=", 
  RowBox[{
   SubscriptBox["\[Rho]", "0"], " ", 
   RowBox[{
    RowBox[{"Sech", "[", 
     RowBox[{"z", "/", 
      RowBox[{"(", 
       RowBox[{"2", "z0"}], ")"}]}], "]"}], "^", "2", " "}]}]}]], "Input",
 CellChangeTimes->{{3.653938122071714*^9, 3.653938209524169*^9}, {
  3.654006888676944*^9, 3.654006900557624*^9}, {3.6540122912738886`*^9, 
  3.6540122914739*^9}, {3.6540324843454523`*^9, 3.6540324848334804`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"Sech", "[", 
    FractionBox["z", 
     RowBox[{"2", " ", "z0"}]], "]"}], "2"], " ", 
  SubscriptBox["\[Rho]", "0"]}]], "Output",
 CellChangeTimes->{
  3.653938210572781*^9, 3.6539466803074512`*^9, 3.6540069607310658`*^9, 
   3.654012302806548*^9, 3.6540144247909184`*^9, 3.654015193840906*^9, 
   3.6540315792596846`*^9, 3.654032529921059*^9, 3.6540327576410837`*^9, 
   3.654032991351452*^9, 3.6540330372410765`*^9, {3.6540332908745832`*^9, 
   3.654033305793437*^9}, 3.654042296455673*^9, 3.6544519914278545`*^9, 
   3.6544522701724153`*^9},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Showing both solutions are the same:", "Subsection",
 CellChangeTimes->{{3.6540069420039945`*^9, 3.654006947084285*^9}, {
   3.654007008834817*^9, 3.6540070150041695`*^9}, 3.654009252474146*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"P1", "==", "P2"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.6539382133458023`*^9, 3.6539382213878527`*^9}, {
  3.6540069517325506`*^9, 3.6540069840593996`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.653938222800016*^9, 3.653946682713953*^9, {3.6540069547707243`*^9, 
   3.654006984402419*^9}, 3.6540123159613004`*^9, 3.654014426601022*^9, 
   3.65401519531599*^9, 3.6540315809007783`*^9, 3.6540325299440603`*^9, 
   3.654032757660085*^9, 3.6540330372600775`*^9, {3.6540332927436905`*^9, 
   3.6540333069195013`*^9}, 3.654042296473674*^9, 3.6544519915838547`*^9, 
   3.654452270188015*^9},
 FontSize->16]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["c)", "Section",
 CellChangeTimes->{{3.6539467570088053`*^9, 3.653946757505851*^9}, {
  3.6540070744825716`*^9, 3.654007075626637*^9}}],

Cell[CellGroupData[{

Cell["\<\
The surface density is found by integrating the volume density from z = -\
\[Infinity] to z = \[Infinity]:\
\>", "Subsection",
 CellChangeTimes->{{3.654014923812461*^9, 3.654014993083423*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalSigma]", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{"P1", ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", 
      RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"z0", ">", "0"}], ",", 
       RowBox[{
        SubscriptBox["\[Rho]", "0"], ">", "0"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.653938770067066*^9, 3.6539388252020903`*^9}, {
  3.653946067501536*^9, 3.653946068292967*^9}, {3.6539466937324467`*^9, 
  3.65394670879423*^9}, {3.654009226602666*^9, 3.6540092417065296`*^9}, {
  3.65401500684421*^9, 3.654015009565366*^9}, {3.654033005243246*^9, 
  3.654033009483489*^9}}],

Cell[BoxData[
 RowBox[{"4", " ", "z0", " ", 
  SubscriptBox["\[Rho]", "0"]}]], "Output",
 CellChangeTimes->{
  3.653938800852427*^9, 3.653938831873188*^9, 3.653946071772023*^9, {
   3.653946697535132*^9, 3.653946711656517*^9}, 3.6540092491119533`*^9, 
   3.6540144404718156`*^9, 3.6540150138596115`*^9, 3.6540315889052362`*^9, 
   3.654032532188189*^9, 3.654032759914214*^9, {3.654032998129839*^9, 
   3.654033039476204*^9}, 3.654033312248806*^9, 3.6540422993498387`*^9, {
   3.654452011926092*^9, 3.6544520258391204`*^9}, 3.6544522733170214`*^9},
 FontSize->16]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Q4", "Subchapter",
 CellChangeTimes->{{3.6540075927082124`*^9, 3.6540075936362658`*^9}}],

Cell[CellGroupData[{

Cell["Integrating over energy e", "Section",
 CellChangeTimes->{{3.6544539912678337`*^9, 3.654453999706316*^9}, {
  3.654454088850415*^9, 3.654454089913476*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Minimum energy required for a star to reach a height z above the midplane \
is equal to the potential energy \[CapitalPhi][z] = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Sigma]", "2"], TraditionalForm]]],
 " \[Phi][z]:"
}], "Subsection",
 CellChangeTimes->{{3.6540125743900814`*^9, 3.654012603517748*^9}, {
   3.6540135659707966`*^9, 3.654013567386878*^9}, {3.654014257619357*^9, 
   3.654014291187277*^9}, {3.654032606463437*^9, 3.654032642247484*^9}, 
   3.6540327961662874`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EzMin", "[", "z_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", "t", "]"}], 
     RowBox[{"\[Sigma]", "^", "2"}]}], "/.", 
    RowBox[{"sQ", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{"t", "\[Rule]", 
     RowBox[{"z", "/", "z0"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.6540126089210567`*^9, 3.6540126307103033`*^9}, {
   3.6540134200534506`*^9, 3.6540134217415476`*^9}, {3.6540134945647125`*^9, 
   3.6540135560752306`*^9}, 3.654032581881031*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[Sigma]", "2"], " ", 
  RowBox[{"Log", "[", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox["z", "z0"]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"z", "/", "z0"}]]}], ")"}], "2"]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.6540126325404077`*^9, 3.6540129829464498`*^9, 3.6540133537656593`*^9, 
   3.654013427803894*^9, {3.6540135052793255`*^9, 3.6540135565572586`*^9}, 
   3.654014514311039*^9, 3.654032532239192*^9, 3.654032650848976*^9, 
   3.654032759949216*^9, 3.654033039512206*^9, 3.654033313651886*^9, 
   3.6540422995068474`*^9, 3.6544522734730215`*^9},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Function to calculate fraction of stars crossing the point z:\
\>", "Subsection",
 CellChangeTimes->{{3.6540128677068586`*^9, 3.6540128838987846`*^9}, 
   3.6540135700910325`*^9, {3.6540328127172346`*^9, 3.6540328183965592`*^9}, 
   3.654042177670879*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"F", "[", "z_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"f", "[", "e", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"e", ",", 
       RowBox[{"EzMin", "[", "z", "]"}], ",", "Infinity"}], "}"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"\[Sigma]", ">", "0"}]}]}], "]"}], "/", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"f", "[", "e", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"e", ",", "0", ",", "Infinity"}], "}"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"\[Sigma]", ">", "0"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6540128569392424`*^9, 3.654012897419558*^9}, {
   3.6540130057057514`*^9, 3.6540130066498055`*^9}, 3.6540132543359723`*^9, {
   3.654013430582053*^9, 3.654013431477104*^9}, {3.654013575235327*^9, 
   3.6540135832357845`*^9}, {3.654031698378498*^9, 3.6540317025347357`*^9}, {
   3.6540330668287687`*^9, 3.654033074987235*^9}, {3.6540333283597274`*^9, 
   3.6540333313538985`*^9}, {3.654037113375218*^9, 3.6540371144622803`*^9}, {
   3.6540372276707554`*^9, 3.6540372286298103`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fraction of stars crossing the point z0:", "Subsection",
 CellChangeTimes->{{3.6540128677068586`*^9, 3.6540128838987846`*^9}, 
   3.6540135700910325`*^9, 3.6540145448727865`*^9, 3.654042175262741*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"F", "[", "z0", "]"}], "->", 
  RowBox[{"N", "[", 
   RowBox[{"F", "[", "z0", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6540134762816668`*^9, 3.654013481371958*^9}, {
  3.6540135892671294`*^9, 3.6540135918602777`*^9}, {3.654013625483201*^9, 
  3.6540136548428802`*^9}, {3.6540371575427437`*^9, 3.654037224941599*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"4", " ", "\[ExponentialE]"}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", "\[ExponentialE]"}], ")"}], "2"]], "\[Rule]", 
  "0.7864477329659274`"}]], "Output",
 CellChangeTimes->{
  3.6540135922312984`*^9, {3.654013634533718*^9, 3.6540136553069067`*^9}, 
   3.654014520014365*^9, 3.6540325322561927`*^9, 3.6540327599672174`*^9, 
   3.6540330395282073`*^9, {3.654033321285323*^9, 3.6540333391473446`*^9}, 
   3.6540371348354454`*^9, {3.6540371875324593`*^9, 3.65403720643054*^9}, 
   3.6540372384803734`*^9, 3.654042306030221*^9, 3.6544522797944336`*^9},
 FontSize->16]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fraction of stars crossing the point 2*z0:", "Subsection",
 CellChangeTimes->{{3.6540128677068586`*^9, 3.6540128838987846`*^9}, 
   3.6540135700910325`*^9, {3.6540145469449053`*^9, 3.654014557128488*^9}, {
   3.6540318822150126`*^9, 3.654031886087234*^9}, 3.6540421717665415`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{"2", "z0"}], "]"}], " ", "\[Rule]", 
  RowBox[{"N", "[", 
   RowBox[{"F", "[", 
    RowBox[{"2", "z0"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6540135938773932`*^9, 3.6540135982036405`*^9}, {
  3.654013659147126*^9, 3.6540136654744883`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["\[ExponentialE]", "2"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", "2"]}], ")"}], "2"]], "\[Rule]", 
  "0.4199743416140261`"}]], "Output",
 CellChangeTimes->{
  3.6540136020218587`*^9, 3.6540136725258913`*^9, 3.6540325360084076`*^9, 
   3.6540327636094255`*^9, {3.6540330431214128`*^9, 3.654033082083641*^9}, 
   3.6540333469427905`*^9, 3.654037245995803*^9, 3.654042312803608*^9, 
   3.6544522865314474`*^9},
 FontSize->16]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1296, 726},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{594.9599999999999, 842.04},
"PrintingMargins"->{{39.826772085, 39.826772085}, {54.99212657999999, \
54.99212657999999}}},
Magnification:>1.1 Inherited,
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 29, 2015)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData[All]]}, Visible -> False, FrontEndVersion -> 
  "10.2 for Microsoft Windows (64-bit) (July 29, 2015)", StyleDefinitions -> 
  "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 166, 3, 99, "Title"],
Cell[CellGroupData[{
Cell[771, 29, 133, 2, 62, "Chapter"],
Cell[CellGroupData[{
Cell[929, 35, 90, 1, 74, "Subchapter"],
Cell[CellGroupData[{
Cell[1044, 40, 426, 7, 53, "Subsection"],
Cell[CellGroupData[{
Cell[1495, 51, 842, 23, 32, "Input"],
Cell[2340, 76, 1059, 25, 58, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3448, 107, 181, 2, 53, "Subsection"],
Cell[CellGroupData[{
Cell[3654, 113, 257, 7, 32, "Input"],
Cell[3914, 122, 787, 20, 61, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4750, 148, 333, 4, 53, "Subsection"],
Cell[CellGroupData[{
Cell[5108, 156, 1070, 24, 32, "Input"],
Cell[6181, 182, 1490, 38, 63, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7720, 226, 180, 2, 53, "Subsection"],
Cell[CellGroupData[{
Cell[7925, 232, 897, 18, 32, "Input"],
Cell[8825, 252, 680, 9, 33, "Output"]
}, Open  ]],
Cell[9520, 264, 410, 7, 53, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9967, 276, 130, 1, 53, "Subsection"],
Cell[CellGroupData[{
Cell[10122, 281, 622, 18, 32, "Input"],
Cell[10747, 301, 744, 18, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11540, 325, 238, 5, 53, "Subsection"],
Cell[CellGroupData[{
Cell[11803, 334, 261, 7, 32, "Input"],
Cell[12067, 343, 481, 7, 36, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12597, 356, 422, 9, 53, "Subsection"],
Cell[CellGroupData[{
Cell[13044, 369, 430, 12, 32, "Input"],
Cell[13477, 383, 480, 10, 36, "Output"]
}, Open  ]]
}, Open  ]],
Cell[13984, 397, 210, 5, 53, "Subsection"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14231, 407, 92, 1, 74, "Subchapter"],
Cell[CellGroupData[{
Cell[14348, 412, 89, 1, 78, "Section"],
Cell[CellGroupData[{
Cell[14462, 417, 126, 1, 53, "Subsection"],
Cell[CellGroupData[{
Cell[14613, 422, 723, 17, 32, "Input"],
Cell[15339, 441, 763, 20, 73, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16151, 467, 349, 10, 53, "Subsection"],
Cell[CellGroupData[{
Cell[16525, 481, 318, 9, 32, "Input"],
Cell[16846, 492, 494, 11, 58, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17389, 509, 184, 4, 53, "Subsection"],
Cell[CellGroupData[{
Cell[17598, 517, 737, 17, 32, "Input"],
Cell[18338, 536, 707, 16, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19094, 558, 143, 2, 53, "Subsection"],
Cell[CellGroupData[{
Cell[19262, 564, 587, 14, 32, "Input"],
Cell[19852, 580, 741, 17, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20642, 603, 454, 10, 53, "Subsection"],
Cell[21099, 615, 139, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[21263, 622, 1301, 30, 32, "Input"],
Cell[22567, 654, 1261, 33, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23865, 692, 492, 8, 32, "Input"],
Cell[24360, 702, 1156, 25, 41, "Output"]
}, Open  ]]
}, Open  ]],
Cell[25543, 731, 296, 9, 53, "Subsection"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25876, 745, 138, 2, 78, "Section"],
Cell[CellGroupData[{
Cell[26039, 751, 899, 19, 32, "Input"],
Cell[26941, 772, 1050, 24, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28028, 801, 128, 1, 53, "Subsection"],
Cell[CellGroupData[{
Cell[28181, 806, 845, 20, 32, "Input"],
Cell[29029, 828, 889, 20, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29967, 854, 125, 1, 53, "Subsection"],
Cell[CellGroupData[{
Cell[30117, 859, 454, 11, 32, "Input"],
Cell[30574, 872, 613, 14, 54, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31236, 892, 200, 2, 53, "Subsection"],
Cell[CellGroupData[{
Cell[31461, 898, 206, 4, 32, "Input"],
Cell[31670, 904, 460, 8, 36, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32191, 919, 140, 2, 78, "Section"],
Cell[CellGroupData[{
Cell[32356, 925, 202, 4, 53, "Subsection"],
Cell[CellGroupData[{
Cell[32583, 933, 731, 18, 32, "Input"],
Cell[33317, 953, 562, 10, 36, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33952, 971, 94, 1, 74, "Subchapter"],
Cell[CellGroupData[{
Cell[34071, 976, 161, 2, 78, "Section"],
Cell[CellGroupData[{
Cell[34257, 982, 507, 11, 53, "Subsection"],
Cell[CellGroupData[{
Cell[34789, 997, 559, 15, 32, "Input"],
Cell[35351, 1014, 785, 20, 54, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36185, 1040, 265, 5, 53, "Subsection"],
Cell[36453, 1047, 1141, 25, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37631, 1077, 206, 2, 53, "Subsection"],
Cell[CellGroupData[{
Cell[37862, 1083, 357, 7, 32, "Input"],
Cell[38222, 1092, 635, 14, 59, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38906, 1112, 286, 3, 53, "Subsection"],
Cell[CellGroupData[{
Cell[39217, 1119, 307, 8, 32, "Input"],
Cell[39527, 1129, 566, 15, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
